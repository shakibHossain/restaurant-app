{"dependencies":[{"name":"tiny-queue","data":{"isAsync":false}},{"name":"immediate","data":{"isAsync":false}},{"name":"noop-fn","data":{"isAsync":false}},{"name":"./WebSQLTransaction","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){'use strict';var n=r(d[0]),t=r(d[1]),s=r(d[2]),c=r(d[3]),o=[{sql:'ROLLBACK;',args:[]}],u=[{sql:'END;',args:[]}];function _(n,t,s,c){this.readOnly=n,this.txnCallback=t,this.errorCallback=s,this.successCallback=c}function h(t,s){this.version=t,this._db=s,this._txnQueue=new n,this._running=!1,this._currentTask=null}h.prototype._onTransactionComplete=function(n){var t=this;function s(){n?t._currentTask.errorCallback(n):t._currentTask.successCallback(),t._running=!1,t._currentTask=null,t._runNextTransaction()}t._currentTask.readOnly?s():n?t._db.exec(o,!1,s):t._db.exec(u,!1,s)},h.prototype._runTransaction=function(){var n=this,s=new c(n);t(function(){n._currentTask.txnCallback(s),s._checkDone()})},h.prototype._runNextTransaction=function(){if(!this._running){var n=this._txnQueue.shift();n&&(this._currentTask=n,this._running=!0,this._runTransaction())}},h.prototype._createTransaction=function(n,t,c,o){if(c=c||s,o=o||s,'function'!=typeof t)throw new Error('The callback provided as parameter 1 is not a function.');this._txnQueue.push(new _(n,t,c,o)),this._runNextTransaction()},h.prototype.transaction=function(n,t,s){this._createTransaction(!1,n,t,s)},h.prototype.readTransaction=function(n,t,s){this._createTransaction(!0,n,t,s)},m.exports=h});","map":[[1,28,1,0],[1,41,3,0],[1,45,3,4,"Queue"],[1,47,3,12,"require"],[1,49,3,19,"d"],[1,51,3,19],[1,55,4,4,"immediate"],[1,57,4,16,"require"],[1,59,4,23,"d"],[1,61,4,23],[1,65,5,4,"noop"],[1,67,5,11,"require"],[1,69,5,18,"d"],[1,71,5,18],[1,75,7,4,"WebSQLTransaction"],[1,77,7,24,"require"],[1,79,7,31,"d"],[1,81,7,31],[1,85,9,4,"ROLLBACK"],[1,89,10,3,"sql"],[1,93,10,8],[1,105,10,21,"args"],[1,115,13,4,"COMMIT"],[1,119,14,3,"sql"],[1,123,14,8],[1,130,14,16,"args"],[1,140,18,0],[1,149,18,9,"TransactionTask"],[1,151,18,25,"readOnly"],[1,153,18,35,"txnCallback"],[1,155,18,48,"errorCallback"],[1,157,18,63,"successCallback"],[1,160,19,2,"this"],[1,165,19,7,"readOnly"],[1,174,19,18,"readOnly"],[1,176,20,2,"this"],[1,181,20,7,"txnCallback"],[1,193,20,21,"txnCallback"],[1,195,21,2,"this"],[1,200,21,7,"errorCallback"],[1,214,21,23,"errorCallback"],[1,216,22,2,"this"],[1,221,22,7,"successCallback"],[1,237,22,25,"successCallback"],[1,239,25,0],[1,248,25,9,"WebSQLDatabase"],[1,250,25,24,"dbVersion"],[1,252,25,35,"db"],[1,255,26,2,"this"],[1,260,26,7,"version"],[1,268,26,17,"dbVersion"],[1,270,27,2,"this"],[1,275,27,7,"_db"],[1,279,27,13,"db"],[1,281,28,2,"this"],[1,286,28,7,"_txnQueue"],[1,296,28,19],[1,300,28,23,"Queue"],[1,302,29,2,"this"],[1,307,29,7,"_running"],[1,317,29,18],[1,319,30,2,"this"],[1,324,30,7,"_currentTask"],[1,337,30,22],[1,342,33,0,"WebSQLDatabase"],[1,344,33,15,"prototype"],[1,354,33,25,"_onTransactionComplete"],[1,377,33,50],[1,386,33,59,"err"],[1,389,34,2],[1,393,34,6,"self"],[1,395,34,13,"this"],[1,400,36,2],[1,409,36,11,"done"],[1,413,37,8,"err"],[1,415,38,6,"self"],[1,417,38,11,"_currentTask"],[1,430,38,24,"errorCallback"],[1,444,38,38,"err"],[1,447,40,6,"self"],[1,449,40,11,"_currentTask"],[1,462,40,24,"successCallback"],[1,480,42,4,"self"],[1,482,42,9,"_running"],[1,492,42,20],[1,494,43,4,"self"],[1,496,43,9,"_currentTask"],[1,509,43,24],[1,514,44,4,"self"],[1,516,44,9,"_runNextTransaction"],[1,538,47,6,"self"],[1,540,47,11,"_currentTask"],[1,553,47,24,"readOnly"],[1,562,48,4,"done"],[1,566,49,13,"err"],[1,568,50,4,"self"],[1,570,50,9,"_db"],[1,574,50,13,"exec"],[1,579,50,18,"ROLLBACK"],[1,582,50,28],[1,584,50,35,"done"],[1,587,52,4,"self"],[1,589,52,9,"_db"],[1,593,52,13,"exec"],[1,598,52,18,"COMMIT"],[1,601,52,26],[1,603,52,33,"done"],[1,607,56,0,"WebSQLDatabase"],[1,609,56,15,"prototype"],[1,619,56,25,"_runTransaction"],[1,635,56,43],[1,646,57,2],[1,650,57,6,"self"],[1,652,57,13,"this"],[1,657,58,6,"txn"],[1,659,58,12],[1,663,58,16,"WebSQLTransaction"],[1,665,58,34,"self"],[1,668,60,2,"immediate"],[1,670,60,12],[1,681,61,4,"self"],[1,683,61,9,"_currentTask"],[1,696,61,22,"txnCallback"],[1,708,61,34,"txn"],[1,711,62,4,"txn"],[1,713,62,8,"_checkDone"],[1,729,66,0,"WebSQLDatabase"],[1,731,66,15,"prototype"],[1,741,66,25,"_runNextTransaction"],[1,761,66,47],[1,772,67,2],[1,776,67,6,"this"],[1,781,67,11,"_running"],[1,790,67,2],[1,791,70,2],[1,795,70,6,"task"],[1,797,70,13,"this"],[1,802,70,18,"_txnQueue"],[1,812,70,28,"shift"],[1,820,72,7,"task"],[1,824,76,2,"this"],[1,829,76,7,"_currentTask"],[1,842,76,22,"task"],[1,844,77,2,"this"],[1,849,77,7,"_running"],[1,859,77,18],[1,861,78,2,"this"],[1,866,78,7,"_runTransaction"],[1,887,81,0,"WebSQLDatabase"],[1,889,81,15,"prototype"],[1,899,81,25,"_createTransaction"],[1,918,81,46],[1,927,82,4,"readOnly"],[1,929,82,14,"txnCallback"],[1,931,82,27,"errorCallback"],[1,933,82,42,"successCallback"],[1,936,86,2],[1,939,83,2,"errorCallback"],[1,941,83,18,"errorCallback"],[1,944,83,35,"noop"],[1,946,84,2,"successCallback"],[1,948,84,20,"successCallback"],[1,951,84,39,"noop"],[1,953,86,29],[1,972,86,13,"txnCallback"],[1,974,87,4],[1,980,87,10],[1,984,87,14,"Error"],[1,990,87,20],[1,1049,90,2,"this"],[1,1054,90,7,"_txnQueue"],[1,1064,90,17,"push"],[1,1069,90,22],[1,1073,90,26,"TransactionTask"],[1,1075,90,42,"readOnly"],[1,1077,90,52,"txnCallback"],[1,1079,90,65,"errorCallback"],[1,1081,90,80,"successCallback"],[1,1085,91,2,"this"],[1,1090,91,7,"_runNextTransaction"],[1,1113,94,0,"WebSQLDatabase"],[1,1115,94,15,"prototype"],[1,1125,94,25,"transaction"],[1,1137,94,39],[1,1146,94,49,"txnCallback"],[1,1148,94,62,"errorCallback"],[1,1150,94,77,"successCallback"],[1,1153,95,2,"this"],[1,1158,95,7,"_createTransaction"],[1,1178,95,26],[1,1180,95,33,"txnCallback"],[1,1182,95,46,"errorCallback"],[1,1184,95,61,"successCallback"],[1,1188,98,0,"WebSQLDatabase"],[1,1190,98,15,"prototype"],[1,1200,98,25,"readTransaction"],[1,1216,98,43],[1,1225,98,53,"txnCallback"],[1,1227,98,66,"errorCallback"],[1,1229,98,81,"successCallback"],[1,1232,99,2,"this"],[1,1237,99,7,"_createTransaction"],[1,1257,99,26],[1,1259,99,32,"txnCallback"],[1,1261,99,45,"errorCallback"],[1,1263,99,60,"successCallback"],[1,1267,102,0,"module"],[1,1269,102,7,"exports"],[1,1277,102,17,"WebSQLDatabase"]]},"type":"js/module"}]}